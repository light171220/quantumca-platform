{{template "base.html" .}}

{{define "content"}}
<div class="page-header">
    <h1 class="page-title">Intermediate Certificate Authorities</h1>
    <p>Manage intermediate CA certificates for Tier 2+ customers</p>
</div>

<div class="card">
    <div class="card-header">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h2 class="card-title">Intermediate CA List</h2>
            <button data-modal="createIntermediateModal" class="btn btn-primary">Create Intermediate CA</button>
        </div>
    </div>
    <div class="table-container">
        <table data-sortable="true">
            <thead>
                <tr>
                    <th data-sort="id">ID</th>
                    <th data-sort="common_name">Common Name</th>
                    <th data-sort="customer">Customer</th>
                    <th data-sort="issued">Issued</th>
                    <th data-sort="expires">Expires</th>
                    <th data-sort="status">Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .intermediateCAs}}
                <tr>
                    <td>{{.ID}}</td>
                    <td>{{.CommonName}}</td>
                    <td>Customer {{.CustomerID}}</td>
                    <td>{{.CreatedAt.Format "2006-01-02"}}</td>
                    <td>{{.NotAfter.Format "2006-01-02"}}</td>
                    <td>
                        {{if eq .Status "active"}}
                            <span class="status-badge status-active">Active</span>
                        {{else}}
                            <span class="status-badge status-pending">{{.Status}}</span>
                        {{end}}
                    </td>
                    <td>
                        <button onclick="copyToClipboard('{{.CertificatePEM}}')" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">Copy Cert</button>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Intermediate CA Benefits</h2>
    </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        <div>
            <h4>üè¢ Enterprise Control</h4>
            <p>Full control over certificate issuance within your organization</p>
        </div>
        <div>
            <h4>üîê Enhanced Security</h4>
            <p>Air-gapped operations with offline root CA protection</p>
        </div>
        <div>
            <h4>‚ö° Fast Issuance</h4>
            <p>Issue certificates instantly without external dependencies</p>
        </div>
        <div>
            <h4>üìã Custom Policies</h4>
            <p>Implement custom certificate policies and validation rules</p>
        </div>
    </div>
</div>

<div class="modal" id="createIntermediateModal">
    <div class="modal-content">
        <div class="modal-header">
            <span class="close">&times;</span>
            <h2 class="modal-title">Create Intermediate CA</h2>
        </div>
        <form data-api="/api/v1/intermediate-ca" data-method="POST">
            <div class="form-group">
                <label class="form-label" for="customer_id">Customer (Tier 2+ only)</label>
                <select class="form-select" id="customer_id" name="customer_id" required>
                    <option value="">Select a customer</option>
                    <!-- This would be populated with Tier 2+ customers -->
                </select>
            </div>
            <div class="form-group">
                <label class="form-label" for="common_name">Common Name</label>
                <input type="text" class="form-input" id="common_name" name="common_name" 
                       placeholder="Acme Corp Intermediate CA" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="country">Country</label>
                <input type="text" class="form-input" id="country" name="country" 
                       placeholder="US" maxlength="2" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="state">State/Province</label>
                <input type="text" class="form-input" id="state" name="state" 
                       placeholder="California" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="city">City</label>
                <input type="text" class="form-input" id="city" name="city" 
                       placeholder="San Francisco" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="organization">Organization</label>
                <input type="text" class="form-input" id="organization" name="organization" 
                       placeholder="Acme Corporation" required>
            </div>
            <div class="form-group">
                <label class="form-label" for="organizational_unit">Organizational Unit</label>
                <input type="text" class="form-input" id="organizational_unit" name="organizational_unit" 
                       placeholder="IT Department">
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Create Intermediate CA</button>
                <button type="button" class="btn btn-secondary close">Cancel</button>
            </div>
        </form>
    </div>
</div>
{{end}}