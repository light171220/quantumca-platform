{{template "base.html" .}}

{{define "content"}}
<div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <p>Welcome to QuantumCA - Your Quantum-Safe Certificate Authority Platform</p>
</div>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-number">{{.stats.ActiveCertificates}}</div>
        <div class="stat-label">Active Certificates</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{.stats.TotalCustomers}}</div>
        <div class="stat-label">Customers</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{.stats.IntermediateCAs}}</div>
        <div class="stat-label">Intermediate CAs</div>
    </div>
    <div class="stat-card">
        <div class="stat-number">{{.stats.SystemUptime}}</div>
        <div class="stat-label">Uptime</div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Quick Actions</h2>
    </div>
    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="/issue-cert" class="btn btn-primary">Issue New Certificate</a>
        <a href="/customers" class="btn btn-secondary">Manage Customers</a>
        <a href="/intermediate-ca" class="btn btn-secondary">Intermediate CAs</a>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Recent Certificates</h2>
    </div>
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th>Common Name</th>
                    <th>Customer</th>
                    <th>Issued</th>
                    <th>Expires</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {{range .recentCertificates}}
                <tr>
                    <td>{{.CommonName}}</td>
                    <td>Customer {{.CustomerID}}</td>
                    <td>{{.CreatedAt.Format "2006-01-02"}}</td>
                    <td>{{.NotAfter.Format "2006-01-02"}}</td>
                    <td>
                        {{if eq .Status "active"}}
                            <span class="status-badge status-active">Active</span>
                        {{else if eq .Status "revoked"}}
                            <span class="status-badge status-revoked">Revoked</span>
                        {{else}}
                            <span class="status-badge status-pending">{{.Status}}</span>
                        {{end}}
                    </td>
                </tr>
                {{else}}
                <tr>
                    <td colspan="5" style="text-align: center; color: #6b7280;">No certificates issued yet</td>
                </tr>
                {{end}}
            </tbody>
        </table>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">System Status</h2>
    </div>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div>
            <strong>Root CA:</strong>
            <span class="status-badge {{if .systemStatus.RootCA}}status-active{{else}}status-revoked{{end}}" style="margin-left: 0.5rem;">
                {{if .systemStatus.RootCA}}Healthy{{else}}Error{{end}}
            </span>
        </div>
        <div>
            <strong>Intermediate CA:</strong>
            <span class="status-badge {{if .systemStatus.IntermediateCA}}status-active{{else}}status-revoked{{end}}" style="margin-left: 0.5rem;">
                {{if .systemStatus.IntermediateCA}}Healthy{{else}}Error{{end}}
            </span>
        </div>
        <div>
            <strong>OCSP Responder:</strong>
            <span class="status-badge {{if .systemStatus.OCSP}}status-active{{else}}status-revoked{{end}}" style="margin-left: 0.5rem;">
                {{if .systemStatus.OCSP}}Online{{else}}Offline{{end}}
            </span>
        </div>
        <div>
            <strong>Database:</strong>
            <span class="status-badge {{if .systemStatus.Database}}status-active{{else}}status-revoked{{end}}" style="margin-left: 0.5rem;">
                {{if .systemStatus.Database}}Connected{{else}}Error{{end}}
            </span>
        </div>
    </div>
</div>
{{end}}